# Apple Silicon から学ぶ CPU の歴史

## Introduction
皆さんは現在利用しているコンピュータの CPU アーキテクチャをご存知でしょうか？アーキテクチャと言っても MVVM, Clean Architecture のようなソフトウェアアーキテクチャではなく、命令セットアーキテクチャと呼ばれるものになります。  
例えば、Intel であれば x86_64, Apple Silicon であれば arm64 が命令セットアーキテクチャです。

本稿では Apple Silicon を中心に CPU に関する歴史を文系・理系関係なく楽しんでいただけるように執筆しました。  
日頃使っている開発環境がどのようなハードウェア設計のもとで動作しているかを知ることで、Apple の素晴らしいハードウェアが更に好きになること間違いなしです！

## 前提
本稿では基礎知識の無い方にも読んでいただけるように心がけて執筆いたしました。そのため、例外を省略して説明している箇所があります。  
例えば「Intel は x86_64 を採用」と言っても、実際には x86_64 と互換性のある様々な製品をリリースしていますし、過去には IA-64 など異なる命令セットアーキテクチャも採用していました。

しかし、内容の間違いや誤解を招く表現が含まれてしまっているかもしれません。本稿は GitHub で管理されており、最新の状態が閲覧できるだけでなく、皆様からのご指摘にも対応可能となっております。ぜひ、ご活用ください。  
GitHub: https://github.com/AkkeyLab/technical-article

## 1. x86_64 / arm64
### 結論
Intel は x86_64 を採用しており、CISC という設計手法がベースになっています。これに対して、Apple Silicon は arm64 を採用しており、RISC という設計手法がベースになっています。

|  メーカ  |  命令セットアーキテクチャ  |  設計手法  |
| ---- | ---- | ---- |
|  Intel  |  x86_64  |  CISC  |
|  Apple Silicon  |  arm64  |  RISC  |

### Instruction Set Architecture
まず、我々が見聞きすることの多い CPU メーカとして Intel, AMD があります。これらのメーカが販売する製品の多くで Windows シリーズが動作します。なぜ、CPU メーカが異なるにも関わらず、同様の OS が動作するのでしょうか。その鍵を握るのが命令セットアーキテクチャ（Instruction Set Architecture）です。

CPU は命令セットアーキテクチャという設計の基礎に基づいて開発されています。イメージとしては、建築方法としての木造と鉄筋のようなものです。  
この命令セットアーキテクチャとして Intel, AMD は共に x86_64 もしくは互換のあるものを採用しているため、同様の OS が起動可能なのです。誤解を恐れず言うのであれば、もしあなたが x86_64 互換のある CPU を自作すれば、Windows も起動可能ということです。

### CISC / RISC
では、x86_64, arm64 にはどのような違いがあるのでしょうか。  
この2つは命令方法（計算方法）に大きな違いがあり、x86_64 は CISC (Complex Instruction Set Computer), arm64 は RISC (Reduce Instruction Set Computer) という設計手法を採用しています。CISC は少ない命令回数で処理を実行するため、1命令あたりの処理が複雑です。逆に RISC は1命令あたりの処理が単純であるため、命令回数は多くなります。

学生時代、数学で公式を頑張って覚えた経験はありますでしょうか。この公式を利用すると答えを導き出すまでのステップを大幅に短縮できることが多いです。これが OS から見た CISC の特徴です。  
ただ、公式の証明が難しいことと同じように、複雑な命令（公式）を解読するための CPU 回路は複雑で、多くのエネルギーを必要とします。  
それであれば、公式を使うのをやめて足し算などの単純な計算のみで計算しよう！というのが RISC の特徴です。足し算であれば殆どの人が計算できることと同じように、CPU 回路も単純で省エネです。  

いかがでしょうか、Apple Silicon が低消費電力を実現できた理由などが見えてきたのではないでしょうか。

## 2. Rosetta / Rosetta2 

## 3. Change CPU Architecture by Apple

## 4. Bibliographic References
- [自作エミュレータで学ぶx86アーキテクチャ コンピュータが動く仕組みを徹底理解！](https://www.amazon.co.jp/dp/B0148FQNVC)
- [Embedded System  - CISC vs RISC](http://www.sharetechnote.com/html/EmbeddedSystem_CISC_RISC.html)